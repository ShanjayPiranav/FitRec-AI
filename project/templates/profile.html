{% extends "base.html" %}

{% block title %}Profile - FitRec AI{% endblock %}

{% block content %}
<div class="main-content">
    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-user-edit text-primary me-2"></i>Edit Profile
                    </h5>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <!-- Basic Information -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold mb-3">
                                    <i class="fas fa-user me-2"></i>Basic Information
                                </h6>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Age</label>
                                <input type="number" class="form-control" name="age" value="{{ user.age }}" min="13" max="100" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Gender</label>
                                <select class="form-select" name="gender" required>
                                    <option value="male" {% if user.gender == 'male' %}selected{% endif %}>Male</option>
                                    <option value="female" {% if user.gender == 'female' %}selected{% endif %}>Female</option>
                                    <option value="other" {% if user.gender == 'other' %}selected{% endif %}>Other</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Weight (kg)</label>
                                <input type="number" class="form-control" name="weight" value="{{ user.weight }}" min="30" max="300" step="0.1" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Height (cm)</label>
                                <input type="number" class="form-control" name="height" value="{{ user.height }}" min="100" max="250" step="0.1" required>
                            </div>
                        </div>

                        <!-- Fitness Profile -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold mb-3">
                                    <i class="fas fa-dumbbell me-2"></i>Fitness Profile
                                </h6>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Fitness Level</label>
                                <select class="form-select" name="fitness_level" required>
                                    <option value="beginner" {% if user.fitness_level == 'beginner' %}selected{% endif %}>Beginner</option>
                                    <option value="intermediate" {% if user.fitness_level == 'intermediate' %}selected{% endif %}>Intermediate</option>
                                    <option value="advanced" {% if user.fitness_level == 'advanced' %}selected{% endif %}>Advanced</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Primary Goal</label>
                                <select class="form-select" name="goals" required>
                                    <option value="weight_loss" {% if user.goals == 'weight_loss' %}selected{% endif %}>Weight Loss</option>
                                    <option value="muscle_gain" {% if user.goals == 'muscle_gain' %}selected{% endif %}>Muscle Gain</option>
                                    <option value="endurance" {% if user.goals == 'endurance' %}selected{% endif %}>Endurance</option>
                                    <option value="flexibility" {% if user.goals == 'flexibility' %}selected{% endif %}>Flexibility</option>
                                    <option value="strength" {% if user.goals == 'strength' %}selected{% endif %}>Strength</option>
                                    <option value="maintenance" {% if user.goals == 'maintenance' %}selected{% endif %}>Maintenance</option>
                                </select>
                            </div>
                        </div>

                        <!-- Preferences -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold mb-3">
                                    <i class="fas fa-cog me-2"></i>Preferences
                                </h6>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Preferred Equipment</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="equipment" value="bodyweight" 
                                           {% if 'bodyweight' in user.get_preferences().get('equipment', []) %}checked{% endif %}>
                                    <label class="form-check-label">Bodyweight</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="equipment" value="dumbbells"
                                           {% if 'dumbbells' in user.get_preferences().get('equipment', []) %}checked{% endif %}>
                                    <label class="form-check-label">Dumbbells</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="equipment" value="barbell"
                                           {% if 'barbell' in user.get_preferences().get('equipment', []) %}checked{% endif %}>
                                    <label class="form-check-label">Barbell</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="equipment" value="cardio"
                                           {% if 'cardio' in user.get_preferences().get('equipment', []) %}checked{% endif %}>
                                    <label class="form-check-label">Cardio Equipment</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="equipment" value="yoga mat"
                                           {% if 'yoga mat' in user.get_preferences().get('equipment', []) %}checked{% endif %}>
                                    <label class="form-check-label">Yoga Mat</label>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Preferred Duration (minutes)</label>
                                <select class="form-select" name="preferred_duration">
                                    <option value="15" {% if user.get_preferences().get('preferred_duration') == 15 %}selected{% endif %}>15 minutes</option>
                                    <option value="30" {% if user.get_preferences().get('preferred_duration') == 30 %}selected{% endif %}>30 minutes</option>
                                    <option value="45" {% if user.get_preferences().get('preferred_duration') == 45 %}selected{% endif %}>45 minutes</option>
                                    <option value="60" {% if user.get_preferences().get('preferred_duration') == 60 %}selected{% endif %}>60 minutes</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Preferred Time of Day</label>
                                <select class="form-select" name="time_of_day">
                                    <option value="morning" {% if user.get_preferences().get('time_of_day') == 'morning' %}selected{% endif %}>Morning</option>
                                    <option value="afternoon" {% if user.get_preferences().get('time_of_day') == 'afternoon' %}selected{% endif %}>Afternoon</option>
                                    <option value="evening" {% if user.get_preferences().get('time_of_day') == 'evening' %}selected{% endif %}>Evening</option>
                                </select>
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <!-- Profile Summary -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-user text-primary me-2"></i>Profile Summary
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
                            <i class="fas fa-user fa-2x"></i>
                        </div>
                        <h5 class="mt-2 mb-1">{{ user.username }}</h5>
                        <p class="text-muted mb-0">{{ user.email }}</p>
                    </div>
                    
                    <div class="row text-center">
                        <div class="col-6">
                            <h6 class="fw-bold">{{ user.age }}</h6>
                            <small class="text-muted">Age</small>
                        </div>
                        <div class="col-6">
                            <h6 class="fw-bold">{{ user.weight }}kg</h6>
                            <small class="text-muted">Weight</small>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="mb-2">
                        <strong>Fitness Level:</strong><br>
                        <span class="badge bg-{{ 'success' if user.fitness_level == 'beginner' else 'warning' if user.fitness_level == 'intermediate' else 'danger' }}">
                            {{ user.fitness_level|title }}
                        </span>
                    </div>
                    
                    <div class="mb-2">
                        <strong>Primary Goal:</strong><br>
                        <span class="text-muted">{{ user.goals|replace('_', ' ')|title }}</span>
                    </div>
                    
                    <div class="mb-2">
                        <strong>Member Since:</strong><br>
                        <span class="text-muted">{{ user.created_at.strftime('%B %Y') }}</span>
                    </div>
                </div>
            </div>

            <!-- BMI Calculator -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-calculator text-primary me-2"></i>BMI Calculator
                    </h5>
                </div>
                <div class="card-body">
                    {% set bmi = user.weight / ((user.height / 100) ** 2) %}
                    <div class="text-center mb-3">
                        <h3 class="fw-bold text-primary">{{ "%.1f"|format(bmi) }}</h3>
                        <p class="text-muted mb-0">Your BMI</p>
                    </div>
                    
                    <div class="progress mb-2" style="height: 8px;">
                        {% if bmi < 18.5 %}
                            <div class="progress-bar bg-info" style="width: 25%"></div>
                        {% elif bmi < 25 %}
                            <div class="progress-bar bg-success" style="width: 50%"></div>
                        {% elif bmi < 30 %}
                            <div class="progress-bar bg-warning" style="width: 75%"></div>
                        {% else %}
                            <div class="progress-bar bg-danger" style="width: 100%"></div>
                        {% endif %}
                    </div>
                    
                    <div class="text-center">
                        {% if bmi < 18.5 %}
                            <span class="badge bg-info">Underweight</span>
                        {% elif bmi < 25 %}
                            <span class="badge bg-success">Normal</span>
                        {% elif bmi < 30 %}
                            <span class="badge bg-warning">Overweight</span>
                        {% else %}
                            <span class="badge bg-danger">Obese</span>
                        {% endif %}
                    </div>
                    
                    <small class="text-muted d-block text-center mt-2">
                        BMI ranges: Underweight < 18.5 | Normal 18.5-24.9 | Overweight 25-29.9 | Obese ≥ 30
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
